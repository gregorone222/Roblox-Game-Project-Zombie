<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox FPS - Advanced HP HUD Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Font: Rajdhani untuk nuansa Tech/Sci-Fi -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: #0f172a;
            background-image: url('https://placehold.co/1920x1080/111827/1f2937?text=Game+Environment');
            background-size: cover;
            background-position: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* --- Custom Clip Paths for Tactical Shape --- */
        .clip-tactical {
            clip-path: polygon(0 0, 100% 0, 95% 100%, 0% 100%);
        }
        
        .clip-slant-right {
            clip-path: polygon(0 0, 100% 0, 85% 100%, 0% 100%);
        }

        /* --- Animations --- */
        @keyframes pulse-critical {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); border-color: rgba(239, 68, 68, 0.2); }
            50% { box-shadow: 0 0 20px 0 rgba(239, 68, 68, 0.5); border-color: rgba(239, 68, 68, 1); }
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-50px) scale(1.2); opacity: 0; }
        }

        .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        .animate-pulse-critical { animation: pulse-critical 1s infinite; }
        .animate-float { animation: floatUp 0.8s ease-out forwards; }

        /* --- Transitions --- */
        .bar-transition { transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .ghost-transition { transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.3s; } /* Delayed transition for ghost bar */

        /* --- Vignette for Low HP --- */
        .vignette-critical {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle, transparent 50%, rgba(220, 38, 38, 0.6) 100%);
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
            z-index: 0;
        }
        .vignette-critical.active { opacity: 1; animation: pulse-vignette 2s infinite; }

        @keyframes pulse-vignette {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 0.8; }
        }

    </style>
</head>
<body class="flex flex-col justify-between">

    <!-- Simulation Controls (Top Right) -->
    <div class="absolute top-4 right-4 bg-slate-900/90 p-4 rounded-lg border border-slate-700 backdrop-blur-md z-50 w-64">
        <h2 class="text-white font-bold mb-3 text-sm uppercase tracking-wider border-b border-slate-700 pb-2">Controls Simulator</h2>
        <div class="space-y-2">
            <button onclick="takeDamage(15)" class="w-full py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded text-sm transition">Hit Damage (-15 HP)</button>
            <button onclick="addShield(20)" class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded text-sm transition">Add Shield (+20)</button>
            <button onclick="heal(20)" class="w-full py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded text-sm transition">Heal (+20 HP)</button>
            <button onclick="toggleKnock()" class="w-full py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded text-sm transition">Toggle Knocked</button>
        </div>
        <div class="mt-4 text-xs text-slate-400">
            <p>State: <span id="debug-state" class="text-white font-bold">Normal</span></p>
        </div>
    </div>

    <!-- Low HP Vignette -->
    <div id="vignette" class="vignette-critical"></div>

    <!-- Content Area (Game View) -->
    <div class="flex-grow relative">
        <!-- Floating Text Container -->
        <div id="floating-text-container" class="absolute bottom-40 left-32 w-40 h-40 pointer-events-none"></div>
    </div>

    <!-- HUD CONTAINER (Bottom Left) -->
    <div id="hud-container" class="relative m-8 mb-8 flex items-end gap-4 z-10 transform transition-transform duration-100">
        
        <!-- 1. Portrait / Level Module -->
        <div class="relative w-24 h-24 flex-shrink-0">
            <!-- Circular Progress (Level/Stamina) -->
            <svg class="w-full h-full -rotate-90 transform" viewBox="0 0 36 36">
                <path class="text-slate-800" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" />
                <path class="text-amber-400 drop-shadow-[0_0_5px_rgba(251,191,36,0.8)]" stroke-dasharray="75, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" />
            </svg>
            
            <!-- Avatar Image -->
            <div class="absolute inset-[10%] rounded-full overflow-hidden border-2 border-slate-600 bg-slate-800">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Soldier" class="w-full h-full object-cover" id="avatar-img">
            </div>

            <!-- Level Badge -->
            <div class="absolute -bottom-1 left-1/2 transform -translate-x-1/2 bg-slate-900 border border-slate-600 text-white text-xs font-bold px-2 py-0.5 rounded shadow-lg z-20">
                LV. 42
            </div>
        </div>

        <!-- 2. Bars Container -->
        <div class="flex flex-col gap-1 w-[350px] pb-2">
            
            <!-- Player Name & Status -->
            <div class="flex justify-between items-end px-1">
                <div class="flex items-center gap-2">
                    <span class="text-white font-bold text-lg tracking-wider drop-shadow-md">SURVIVOR</span>
                    <div class="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_5px_rgba(34,197,94,1)] animate-pulse"></div>
                </div>
                <div class="text-xl font-bold text-white tabular-nums drop-shadow-md">
                    <span id="current-hp-text" class="text-2xl">100</span><span class="text-slate-400 text-sm">/100</span>
                </div>
            </div>

            <!-- SHIELD BAR (Thin, Top) -->
            <div class="relative h-2 w-full bg-slate-800/80 rounded-sm overflow-hidden border border-slate-700/50 mb-[-2px] z-10">
                <div id="shield-bar" class="h-full bg-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.8)] bar-transition" style="width: 0%;"></div>
                <!-- Shield Glow -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-30 w-full h-full"></div>
            </div>

            <!-- HEALTH BAR (Main) -->
            <div id="health-bar-container" class="relative h-8 w-full bg-slate-900/90 rounded-r-lg border-l-4 border-green-500 overflow-hidden shadow-lg backdrop-blur-sm clip-tactical transition-colors duration-300">
                
                <!-- Ghost Bar (Damage Feedback) -->
                <div id="ghost-bar" class="absolute top-0 left-0 h-full bg-white w-full ghost-transition opacity-60"></div>

                <!-- Actual Health Fill -->
                <div id="health-bar" class="absolute top-0 left-0 h-full bg-gradient-to-r from-green-600 to-green-500 w-full bar-transition flex items-center justify-end pr-2 overflow-hidden relative">
                    <!-- Stripes Pattern -->
                    <div class="absolute inset-0 w-full h-full" style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.1) 10px, rgba(0,0,0,0.1) 20px);"></div>
                    <!-- Shine -->
                    <div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div>
                </div>

            </div>

            <!-- Stamina / Extra Info -->
            <div class="flex justify-between items-center mt-1">
                <div class="flex gap-1 h-1.5 w-32">
                    <div class="flex-1 bg-amber-500 rounded-sm opacity-100"></div>
                    <div class="flex-1 bg-amber-500 rounded-sm opacity-100"></div>
                    <div class="flex-1 bg-amber-500 rounded-sm opacity-100"></div>
                    <div class="flex-1 bg-amber-500 rounded-sm opacity-40"></div>
                </div>
                <span class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Shield Active</span>
            </div>

        </div>

    </div>


    <script>
        // --- Configuration ---
        const MAX_HP = 100;
        const MAX_SHIELD = 50;
        let currentHP = 100;
        let currentShield = 0;
        let isKnocked = false;

        // --- DOM Elements ---
        const healthBar = document.getElementById('health-bar');
        const ghostBar = document.getElementById('ghost-bar');
        const shieldBar = document.getElementById('shield-bar');
        const hpText = document.getElementById('current-hp-text');
        const hudContainer = document.getElementById('hud-container');
        const vignette = document.getElementById('vignette');
        const hpContainerBorder = document.getElementById('health-bar-container');
        const floatingTextContainer = document.getElementById('floating-text-container');
        const debugState = document.getElementById('debug-state');
        const avatarImg = document.getElementById('avatar-img');

        // --- Core Functions ---

        function updateUI() {
            // 1. Calculate Percentages
            const hpPercent = (currentHP / MAX_HP) * 100;
            const shieldPercent = (currentShield / MAX_SHIELD) * 100;

            // 2. Update Bar Widths
            healthBar.style.width = `${hpPercent}%`;
            ghostBar.style.width = `${hpPercent}%`; // Ghost bar transition is delayed via CSS
            shieldBar.style.width = `${shieldPercent}%`;

            // 3. Update Text (Rolling numbers animation logic simplified here)
            hpText.innerText = Math.ceil(currentHP);

            // 4. Health Color Logic
            healthBar.className = `absolute top-0 left-0 h-full w-full bar-transition flex items-center justify-end pr-2 overflow-hidden relative bg-gradient-to-r`;
            
            if (currentHP > 50) {
                // Green
                healthBar.classList.add('from-green-600', 'to-green-500');
                hpContainerBorder.style.borderColor = '#22c55e'; // Green border
            } else if (currentHP > 25) {
                // Yellow/Amber
                healthBar.classList.add('from-amber-500', 'to-yellow-500');
                hpContainerBorder.style.borderColor = '#f59e0b';
            } else {
                // Red (Critical)
                healthBar.classList.add('from-red-700', 'to-red-600');
                hpContainerBorder.style.borderColor = '#ef4444';
            }

            // 5. Low HP Effects
            if (currentHP <= 25 && currentHP > 0) {
                hpContainerBorder.classList.add('animate-pulse-critical');
                vignette.classList.add('active');
            } else {
                hpContainerBorder.classList.remove('animate-pulse-critical');
                vignette.classList.remove('active');
            }

            // 6. Knocked State
            if (isKnocked) {
                healthBar.classList.remove('from-green-600', 'to-green-500', 'from-amber-500', 'to-yellow-500');
                healthBar.classList.add('from-red-900', 'to-red-800');
                hpText.innerText = "KNOCKED";
                hpText.classList.add('text-red-500');
                avatarImg.style.filter = "grayscale(100%)";
            } else {
                hpText.classList.remove('text-red-500');
                avatarImg.style.filter = "none";
            }
        }

        // --- Event Simulators ---

        function takeDamage(amount) {
            if (isKnocked) return;

            // Shield Absorption Logic
            let damageToHp = amount;
            if (currentShield > 0) {
                if (currentShield >= amount) {
                    currentShield -= amount;
                    damageToHp = 0;
                    spawnFloatingText(`-${amount}`, 'blue');
                } else {
                    damageToHp = amount - currentShield;
                    spawnFloatingText(`-${currentShield}`, 'blue'); // Shield break part
                    currentShield = 0;
                }
            }

            if (damageToHp > 0) {
                currentHP = Math.max(0, currentHP - damageToHp);
                spawnFloatingText(`-${damageToHp}`, 'red');
                
                // VFX: Shake
                hudContainer.classList.remove('animate-shake');
                void hudContainer.offsetWidth; // Trigger reflow
                hudContainer.classList.add('animate-shake');
            }

            if (currentHP === 0) {
                toggleKnock(true);
            }

            updateUI();
        }

        function heal(amount) {
            if (isKnocked) return; // Can't heal normally while knocked

            if (currentHP < MAX_HP) {
                const healAmount = Math.min(MAX_HP - currentHP, amount);
                currentHP += healAmount;
                spawnFloatingText(`+${healAmount}`, 'green');
                updateUI();
            }
        }

        function addShield(amount) {
            if (isKnocked) return;

            currentShield = Math.min(MAX_SHIELD, currentShield + amount);
            spawnFloatingText(`+${amount} Shield`, 'cyan');
            updateUI();
        }

        function toggleKnock(forceState = null) {
            if (forceState !== null) {
                isKnocked = forceState;
            } else {
                isKnocked = !isKnocked;
            }

            if (isKnocked) {
                currentHP = 0; // Conceptually 0, but maybe visual bar shows bleedout time in real game
                currentShield = 0;
                debugState.innerText = "KNOCKED DOWN";
                debugState.className = "text-red-500 font-bold";
            } else {
                currentHP = 25; // Revive with some HP
                debugState.innerText = "Normal";
                debugState.className = "text-white font-bold";
            }
            updateUI();
        }

        function spawnFloatingText(text, type) {
            const el = document.createElement('div');
            el.className = `absolute text-2xl font-bold animate-float pointer-events-none drop-shadow-md`;
            el.innerText = text;
            
            // Randomize slight position
            const randX = Math.floor(Math.random() * 40) - 20;
            el.style.left = `${randX}px`;

            if (type === 'red') el.classList.add('text-red-500');
            if (type === 'green') el.classList.add('text-green-400');
            if (type === 'blue') el.classList.add('text-blue-400');
            if (type === 'cyan') el.classList.add('text-cyan-300');

            floatingTextContainer.appendChild(el);

            // Cleanup
            setTimeout(() => {
                el.remove();
            }, 800);
        }

        // Init
        updateUI();

    </script>
</body>
</html>
